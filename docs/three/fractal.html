<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fractal Tree</title>
  <link rel="stylesheet" href="../assets/style.css" />
  <style>body{background:#0b1020}</style>
</head>
<body>
  <div class="container">
    <div class="header"><div class="logo"></div><div><div class="title">Fractal Tree</div><div class="subtitle">Rekurencyjne drzewo w 3D</div></div></div>
    <div class="hero" style="height:460px"><div class="canvas" id="app"></div></div>
    <a class="button" href="index.html">‚Üê Back</a>
  </div>
  <script type="module">
    import * as THREE from 'https://unpkg.com/three@0.161.0/build/three.module.js';
    import {OrbitControls} from 'https://unpkg.com/three@0.161.0/examples/jsm/controls/OrbitControls.js?module';

    const el = document.getElementById('app');
    const renderer = new THREE.WebGLRenderer({antialias:true});
    el.appendChild(renderer.domElement);
    renderer.setPixelRatio(devicePixelRatio);

    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x0b1020);

    const camera = new THREE.PerspectiveCamera(55, 1, 0.1, 1000);
    camera.position.set(0, 6, 16);
    const controls = new OrbitControls(camera, renderer.domElement);

    scene.add(new THREE.AmbientLight(0x88aaff, 0.6));
    const dl = new THREE.DirectionalLight(0xffffff, 0.8); dl.position.set(5,10,7); scene.add(dl);

    const mat = new THREE.MeshStandardMaterial({color:0x22c55e});

    function branch(level, len, pos, dir){
      if(level<=0) return;
      const geo = new THREE.CylinderGeometry(0.03*len, 0.06*len, len, 6);
      const mesh = new THREE.Mesh(geo, mat);
      mesh.position.copy(pos);
      mesh.quaternion.setFromUnitVectors(new THREE.Vector3(0,1,0), dir.clone().normalize());
      mesh.position.add(dir.clone().normalize().multiplyScalar(len/2));
      scene.add(mesh);
      const nextPos = mesh.position.clone().add(dir.clone().normalize().multiplyScalar(len/2));
      const a = Math.PI/6;
      const dirs = [
        dir.clone().applyAxisAngle(new THREE.Vector3(1,0,0), a),
        dir.clone().applyAxisAngle(new THREE.Vector3(-1,0,0), a),
        dir.clone().applyAxisAngle(new THREE.Vector3(0,0,1), a),
      ];
      dirs.forEach(d=> branch(level-1, len*0.68, nextPos, d));
    }

    branch(7, 2.5, new THREE.Vector3(0,0,0), new THREE.Vector3(0,1,0));

    function resize(){
      const w = el.clientWidth, h = el.clientHeight; renderer.setSize(w,h); camera.aspect = w/h; camera.updateProjectionMatrix();
    } window.addEventListener('resize', resize); resize();

    function loop(){ controls.update(); renderer.render(scene, camera); requestAnimationFrame(loop); } requestAnimationFrame(loop);
  </script>
</body>
</html>